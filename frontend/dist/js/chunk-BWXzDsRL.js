import{u as e,a,R as s,j as r,O as t,r as i}from"./chunk-61qy-ame.js";import{u as l}from"./index-DCV20a9Q.js";import{B as n,A as o,T as d,S as c,a as h,C as x,b as u,I as m,E as g,D as j,L as p,c as b,d as f,e as v,f as y,g as C,h as w,i as S,j as N,P as E,k as I,l as P,m as D,H as k,n as A,V as R,o as W,p as z,G as O,q as M,r as U,W as L,s as T,t as G,F as V,u as F,v as H,M as $,w as _,x as B,y as q,z as Q,J as K,K as J,N as X,O as Y,Q as Z,R as ee,U as ae,X as se,Y as re,Z as te,_ as ie,$ as le,a0 as ne,a1 as oe,a2 as de,a3 as ce,a4 as he,a5 as xe,a6 as ue,a7 as me,a8 as ge,a9 as je,aa as pe,ab as be,ac as fe,ad as ve}from"./chunk-B-IQjRUg.js";import{a as ye,n as Ce}from"./chunk-D0fInH4s.js";const we=()=>{var i;const A=e(),R=a(),{user:W,logout:z}=l();s.useEffect(()=>{},[W,R.pathname]),s.useEffect(()=>{if(W&&!O(W.role)){const e=new CustomEvent("showToast",{detail:{type:"error",message:"üö® B·∫°n kh√¥ng c√≥ quy·ªÅn truy c·∫≠p trang admin. B·∫°n s·∫Ω b·ªã ƒëƒÉng xu·∫•t."}});window.dispatchEvent(e),setTimeout(()=>{z(),A("/login")},2e3)}},[W,z,A]),s.useEffect(()=>{if(W&&!O(W.role))return;const e=setInterval(()=>{if(W&&!O(W.role)){const e=new CustomEvent("showToast",{detail:{type:"error",message:"üö® Quy·ªÅn admin c·ªßa b·∫°n ƒë√£ b·ªã thu h·ªìi. B·∫°n s·∫Ω b·ªã ƒëƒÉng xu·∫•t."}});window.dispatchEvent(e),setTimeout(()=>{z(),A("/login")},2e3)}},2e3);return()=>clearInterval(e)},[W,z,A]);const O=e=>["ADMIN","PRODUCT_MANAGER","USER_MANAGER","MODERATOR","REPAIR_TECHNICIAN"].includes(e),M=[{label:"Dashboard",icon:r.jsx(C,{}),path:"/admin",color:"#3b82f6",roles:["ADMIN","PRODUCT_MANAGER","USER_MANAGER","MODERATOR","REPAIR_TECHNICIAN"]},{label:"Orders",icon:r.jsx(w,{}),path:"/admin/orders",color:"#f59e0b",roles:["ADMIN","MODERATOR"]},{label:"Warranty",icon:r.jsx(S,{}),path:"/admin/warranty",color:"#06b6d4",roles:["ADMIN","REPAIR_TECHNICIAN"]},{label:"Products",icon:r.jsx(N,{}),path:"/admin/products",color:"#10b981",roles:["ADMIN","PRODUCT_MANAGER"]},{label:"Users",icon:r.jsx(E,{}),path:"/admin/users",color:"#8b5cf6",roles:["ADMIN","USER_MANAGER"]},{label:"Vouchers",icon:r.jsx(I,{}),path:"/admin/vouchers",color:"#ef4444",roles:["ADMIN","MODERATOR"]},{label:"Analytics",icon:r.jsx(P,{}),path:"/admin/analytics",color:"#06b6d4",roles:["ADMIN"]},{label:"Inventory",icon:r.jsx(N,{}),path:"/admin/inventory",color:"#84cc16",roles:["ADMIN","MODERATOR"]},{label:"Settings",icon:r.jsx(D,{}),path:"/admin/settings",color:"#6b7280",roles:["ADMIN"]},{label:"Audit Logs",icon:r.jsx(k,{}),path:"/admin/audit",color:"#f97316",roles:["ADMIN"]}].filter(e=>e.roles.includes((null==W?void 0:W.role)||"USER"));return r.jsxs(n,{sx:{display:"flex",minHeight:"100vh"},children:[r.jsx(o,{position:"fixed",sx:{zIndex:e=>e.zIndex.drawer+1,background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",boxShadow:"0 8px 32px rgba(102, 126, 234, 0.3)",backdropFilter:"blur(10px)"},children:r.jsxs(d,{sx:{px:3},children:[r.jsxs(n,{sx:{display:"flex",alignItems:"center",gap:2},children:[r.jsx(c,{sx:{fontSize:32,color:"white"}}),r.jsx(h,{variant:"h5",sx:{fontWeight:900,letterSpacing:.5,color:"white"},children:"ShopPro Admin"})]}),r.jsx(n,{sx:{flexGrow:1}}),r.jsxs(n,{sx:{display:"flex",alignItems:"center",gap:2},children:[r.jsx(x,{label:(null==W?void 0:W.role)||"Admin",size:"small",sx:{bgcolor:"rgba(255,255,255,0.2)",color:"white",fontWeight:700,border:"1px solid rgba(255,255,255,0.3)"}}),r.jsx(u,{sx:{width:36,height:36,bgcolor:"rgba(255,255,255,0.2)",border:"2px solid rgba(255,255,255,0.3)"},children:(null==(i=null==W?void 0:W.firstName)?void 0:i.charAt(0))||"A"}),r.jsx(m,{color:"inherit",onClick:()=>A("/"),sx:{bgcolor:"rgba(255,255,255,0.1)","&:hover":{bgcolor:"rgba(255,255,255,0.2)"}},children:r.jsx(c,{})}),r.jsx(m,{color:"inherit",onClick:()=>{z(),A("/")},sx:{bgcolor:"rgba(255,255,255,0.1)","&:hover":{bgcolor:"rgba(255,255,255,0.2)"}},children:r.jsx(g,{})})]})]})}),r.jsxs(j,{variant:"permanent",sx:{width:260,flexShrink:0,"& .MuiDrawer-paper":{width:260,boxSizing:"border-box",borderRight:"1px solid rgba(0,0,0,0.08)",background:"linear-gradient(180deg, #ffffff 0%, #f8fafc 100%)",boxShadow:"4px 0 20px rgba(0,0,0,0.05)"}},children:[r.jsx(d,{}),r.jsx(n,{sx:{px:3,py:2},children:r.jsx(h,{variant:"overline",sx:{color:"text.secondary",fontWeight:800,letterSpacing:1.5,fontSize:"0.75rem"},children:"ADMIN NAVIGATION"})}),r.jsx(p,{sx:{px:2},children:M.map(e=>{const a=e.roles.includes((null==W?void 0:W.role)||"USER");return r.jsxs(b,{selected:R.pathname===e.path,onClick:()=>{if(a)A(e.path);else{const a=new CustomEvent("showToast",{detail:{type:"warning",message:`üö´ B·∫°n kh√¥ng c√≥ quy·ªÅn truy c·∫≠p ${e.label}`}});window.dispatchEvent(a)}},disabled:!a,sx:{borderRadius:2,mb:.5,transition:"all 0.3s ease",opacity:a?1:.4,filter:a?"none":"grayscale(50%)",cursor:a?"pointer":"not-allowed","&.Mui-selected":{bgcolor:a?`${e.color}15`:"rgba(0,0,0,0.05)",color:a?e.color:"text.disabled","&:hover":{bgcolor:a?`${e.color}20`:"rgba(0,0,0,0.05)"},"& .MuiListItemIcon-root":{color:a?e.color:"text.disabled"}},"&:hover":{bgcolor:a?"rgba(0,0,0,0.04)":"rgba(0,0,0,0.02)",transform:a?"translateX(4px)":"none"},"&.Mui-disabled":{opacity:.4,color:"text.disabled","& .MuiListItemIcon-root":{color:"text.disabled"}}},children:[r.jsx(f,{sx:{minWidth:40,color:a?R.pathname===e.path?e.color:"text.secondary":"text.disabled"},children:e.icon}),r.jsx(v,{primary:e.label,primaryTypographyProps:{fontWeight:R.pathname===e.path?700:600,fontSize:"0.9rem",color:a?"inherit":"text.disabled"}})]},e.path)})}),r.jsx(y,{sx:{my:2,mx:2}}),r.jsx(n,{sx:{px:3,py:2},children:r.jsxs(h,{variant:"caption",color:"text.secondary",sx:{fontWeight:600},children:["Logged in as: ",null==W?void 0:W.firstName," ",null==W?void 0:W.lastName]})})]}),r.jsxs(n,{component:"main",sx:{flexGrow:1,background:"linear-gradient(135deg, #f8fafc 0%, #ffffff 100%)",minHeight:"100vh"},children:[r.jsx(d,{}),r.jsx(n,{sx:{p:3},children:r.jsx(t,{})})]})]})},Se=()=>{const[e,a]=i.useState([]),[s,t]=i.useState(0),[l,o]=i.useState(10),[d,c]=i.useState(0),[u,g]=i.useState(!1),[j,p]=i.useState(""),[b,f]=i.useState(null),[v,y]=i.useState(!1),[C,S]=i.useState("PENDING"),[N,E]=i.useState(""),[I,P]=i.useState({open:!1,message:"",severity:"success"}),D=i.useCallback(async()=>{var e,r;g(!0);try{const e=await ye.adminGetOrders(s,l,j||void 0);a(e.data.content||[]),c(e.data.totalElements||0)}catch(t){const a=(null==(r=null==(e=null==t?void 0:t.response)?void 0:e.data)?void 0:r.message)||(null==t?void 0:t.message)||"Error loading orders";k(`Error: ${a}`,"error")}finally{g(!1)}},[s,l,j]);i.useEffect(()=>{D()},[D]);const k=(e,a)=>{P({open:!0,message:e,severity:a})},ie=e=>{switch(e){case"DELIVERED":case"COMPLETED":return"success";case"SHIPPED":case"PROCESSING":return"info";case"PENDING":case"PENDING_APPROVAL":return"warning";case"CANCELLED":case"REFUNDED":return"error";default:return"default"}},le=e=>{switch(e){case"DELIVERED":case"COMPLETED":return r.jsx(te,{fontSize:"small"});case"SHIPPED":return r.jsx(T,{fontSize:"small"});case"PROCESSING":return r.jsx(W,{fontSize:"small"});case"PENDING":case"PENDING_APPROVAL":default:return r.jsx(L,{fontSize:"small"});case"CANCELLED":case"REFUNDED":return r.jsx(re,{fontSize:"small"})}},ne=i.useCallback(e=>{f(e)},[]),oe=i.useCallback(e=>{f(e),S(e.status),E(""),y(!0)},[]),de=i.useCallback(async e=>{try{await ye.cancelOrder(e.id,"Cancelled by admin"),await D(),k("Order cancelled successfully","success")}catch(a){k("Error cancelling order","error")}},[D]),ce=i.useMemo(()=>[{field:"id",headerName:"Order ID",width:100,renderCell:e=>r.jsx(x,{label:`#${e.value}`,size:"small",color:"primary",variant:"outlined"})},{field:"orderNumber",headerName:"Order #",width:160,renderCell:e=>r.jsx(h,{variant:"body2",sx:{fontWeight:600,fontFamily:"monospace"},children:e.value})},{field:"userFullName",headerName:"Customer",flex:1,minWidth:160,renderCell:e=>r.jsxs(n,{children:[r.jsx(h,{variant:"body2",sx:{fontWeight:600},children:e.value}),r.jsxs(h,{variant:"caption",color:"text.secondary",children:["Order #",e.row.orderNumber]})]})},{field:"status",headerName:"Status",width:150,renderCell:e=>r.jsx(x,{label:e.value,size:"small",color:ie(e.value),icon:le(e.value),variant:"outlined"})},{field:"totalAmount",headerName:"Total",width:120,renderCell:e=>r.jsxs(h,{variant:"body2",sx:{fontWeight:700,color:"success.main"},children:["$",Number(e.value).toFixed(2)]})},{field:"createdAt",headerName:"Created",width:180,valueFormatter:e=>new Date(e.value).toLocaleDateString("vi-VN")},{field:"actions",headerName:"Actions",width:320,sortable:!1,filterable:!1,renderCell:e=>r.jsxs(A,{direction:"row",spacing:1,children:[r.jsx(m,{size:"small",color:"info",onClick:()=>ne(e.row),sx:{bgcolor:"info.50","&:hover":{bgcolor:"info.100"}},children:r.jsx(R,{fontSize:"small"})}),r.jsx(m,{size:"small",color:"primary",onClick:()=>oe(e.row),sx:{bgcolor:"primary.50","&:hover":{bgcolor:"primary.100"}},children:r.jsx(W,{fontSize:"small"})}),r.jsx(m,{size:"small",color:"error",onClick:()=>de(e.row),sx:{bgcolor:"error.50","&:hover":{bgcolor:"error.100"}},children:r.jsx(z,{fontSize:"small"})})]})}],[ne,oe,de]);return r.jsxs(n,{children:[r.jsxs(n,{sx:{mb:4},children:[r.jsx(h,{variant:"h4",sx:{fontWeight:900,mb:1,background:"linear-gradient(45deg, #f59e0b 0%, #d97706 100%)",backgroundClip:"text",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent"},children:"Order Management"}),r.jsx(h,{variant:"body1",color:"text.secondary",children:"Manage customer orders, track shipments, and update order statuses"})]}),r.jsxs(O,{container:!0,spacing:3,sx:{mb:4},children:[r.jsx(O,{item:!0,xs:12,sm:6,md:3,children:r.jsx(M,{sx:{height:"100%",background:"linear-gradient(135deg, #f59e0b 0%, #d97706 100%)",color:"white"},children:r.jsx(U,{children:r.jsxs(n,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[r.jsxs(n,{children:[r.jsx(h,{variant:"h4",sx:{fontWeight:900,mb:1},children:d}),r.jsx(h,{variant:"body2",sx:{opacity:.9},children:"Total Orders"})]}),r.jsx(w,{sx:{fontSize:40,opacity:.8}})]})})})}),r.jsx(O,{item:!0,xs:12,sm:6,md:3,children:r.jsx(M,{sx:{height:"100%",background:"linear-gradient(135deg, #3b82f6 0%, #2563eb 100%)",color:"white"},children:r.jsx(U,{children:r.jsxs(n,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[r.jsxs(n,{children:[r.jsx(h,{variant:"h4",sx:{fontWeight:900,mb:1},children:e.filter(e=>"PENDING"===e.status||"PENDING_APPROVAL"===e.status).length}),r.jsx(h,{variant:"body2",sx:{opacity:.9},children:"Pending Orders"})]}),r.jsx(L,{sx:{fontSize:40,opacity:.8}})]})})})}),r.jsx(O,{item:!0,xs:12,sm:6,md:3,children:r.jsx(M,{sx:{height:"100%",background:"linear-gradient(135deg, #10b981 0%, #059669 100%)",color:"white"},children:r.jsx(U,{children:r.jsxs(n,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[r.jsxs(n,{children:[r.jsx(h,{variant:"h4",sx:{fontWeight:900,mb:1},children:e.filter(e=>"SHIPPED"===e.status||"DELIVERED"===e.status).length}),r.jsx(h,{variant:"body2",sx:{opacity:.9},children:"Shipped Orders"})]}),r.jsx(T,{sx:{fontSize:40,opacity:.8}})]})})})}),r.jsx(O,{item:!0,xs:12,sm:6,md:3,children:r.jsx(M,{sx:{height:"100%",background:"linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%)",color:"white"},children:r.jsx(U,{children:r.jsxs(n,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[r.jsxs(n,{children:[r.jsxs(h,{variant:"h4",sx:{fontWeight:900,mb:1},children:["$",e.reduce((e,a)=>e+a.totalAmount,0).toFixed(2)]}),r.jsx(h,{variant:"body2",sx:{opacity:.9},children:"Total Revenue"})]}),r.jsx(G,{sx:{fontSize:40,opacity:.8}})]})})})})]}),r.jsx(M,{sx:{borderRadius:3,boxShadow:"0 8px 32px rgba(0,0,0,0.08)"},children:r.jsxs(U,{children:[r.jsxs(n,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:[r.jsx(h,{variant:"h6",sx:{fontWeight:700},children:"Order List"}),r.jsxs(V,{size:"small",sx:{width:220},children:[r.jsx(F,{children:"Filter by Status"}),r.jsxs(H,{value:j,label:"Filter by Status",onChange:e=>p(e.target.value),children:[r.jsx($,{value:"",children:"All Orders"}),[{value:"PENDING",label:"Pending"},{value:"PENDING_APPROVAL",label:"Pending Approval"},{value:"APPROVED",label:"Approved"},{value:"CONFIRMED",label:"Confirmed"},{value:"PROCESSING",label:"Processing"},{value:"SHIPPED",label:"Shipped"},{value:"DELIVERED",label:"Delivered"},{value:"COMPLETED",label:"Completed"},{value:"CANCELLED",label:"Cancelled"},{value:"REFUNDED",label:"Refunded"}].map(e=>r.jsx($,{value:e.value,children:e.label},e.value))]})]})]}),r.jsx(n,{sx:{height:600,width:"100%"},children:r.jsx(_,{rows:e,columns:ce,pagination:!0,paginationMode:"server",rowCount:d,pageSizeOptions:[10,25,50],paginationModel:{page:s,pageSize:l},onPaginationModelChange:e=>{t(e.page),o(e.pageSize)},loading:u,getRowId:e=>e.id,sx:{border:"none","& .MuiDataGrid-cell":{borderBottom:"1px solid #f0f0f0"},"& .MuiDataGrid-columnHeaders":{bgcolor:"#f8fafc",borderBottom:"2px solid #e2e8f0"},"& .MuiDataGrid-row:hover":{bgcolor:"#f8fafc"}}})})]})}),r.jsxs(B,{open:v,onClose:()=>y(!1),maxWidth:"sm",fullWidth:!0,children:[r.jsxs(q,{sx:{bgcolor:"primary.main",color:"white",display:"flex",alignItems:"center",gap:1},children:[r.jsx(W,{}),"Update Order Status"]}),r.jsx(Q,{sx:{pt:3},children:r.jsxs(A,{spacing:3,children:[r.jsxs(n,{children:[r.jsx(h,{variant:"subtitle2",color:"text.secondary",sx:{mb:1},children:"Order Details"}),r.jsxs(K,{sx:{p:2,bgcolor:"grey.50"},children:[r.jsxs(h,{variant:"body2",sx:{fontWeight:600},children:["Order #",null==b?void 0:b.orderNumber," - ",null==b?void 0:b.userFullName]}),r.jsxs(h,{variant:"caption",color:"text.secondary",children:["Current Status: ",null==b?void 0:b.status]})]})]}),r.jsxs(V,{fullWidth:!0,children:[r.jsx(F,{children:"New Status"}),r.jsx(H,{value:C,label:"New Status",onChange:e=>S(e.target.value),children:[{value:"PENDING",label:"Pending"},{value:"PENDING_APPROVAL",label:"Pending Approval"},{value:"APPROVED",label:"Approved"},{value:"CONFIRMED",label:"Confirmed"},{value:"PROCESSING",label:"Processing"},{value:"SHIPPED",label:"Shipped"},{value:"DELIVERED",label:"Delivered"},{value:"COMPLETED",label:"Completed"},{value:"CANCELLED",label:"Cancelled"},{value:"REFUNDED",label:"Refunded"}].map(e=>r.jsx($,{value:e.value,children:e.label},e.value))})]}),r.jsx(J,{fullWidth:!0,label:"Reason for Status Change (Optional)",multiline:!0,rows:3,value:N,onChange:e=>E(e.target.value),placeholder:"Enter reason for status change..."})]})}),r.jsxs(X,{sx:{p:3,pt:2},children:[r.jsx(Y,{onClick:()=>y(!1),startIcon:r.jsx(Z,{}),children:"Cancel"}),r.jsx(Y,{variant:"contained",onClick:async()=>{if(b)try{await ye.adminUpdateOrderStatus(b.id,C,N),y(!1),await D(),k("Order status updated successfully","success")}catch(e){k("Error updating order status","error")}},startIcon:r.jsx(ee,{}),children:"Update Status"})]})]}),r.jsx(ae,{open:I.open,autoHideDuration:6e3,onClose:()=>P({...I,open:!1}),children:r.jsx(se,{onClose:()=>P({...I,open:!1}),severity:I.severity,sx:{width:"100%"},children:I.message})})]})},Ne=()=>{const[e,a]=i.useState([]),[s,t]=i.useState(0),[l,o]=i.useState(10),[d,u]=i.useState(0),[g,j]=i.useState(!1),[p,b]=i.useState(null),[f,v]=i.useState([]),[y,C]=i.useState(!1),[w,S]=i.useState(!1),[E,I]=i.useState(null),[P,D]=i.useState({variantName:"",sku:"",color:"",size:"",price:0,stockQuantity:0,isActive:!0,isDefault:!1});i.useEffect(()=>{},[]);const[k,L]=i.useState(null),[T,V]=i.useState(!1),[F,H]=i.useState(!1),[$,Z]=i.useState(!1),[re,te]=i.useState({}),[he,xe]=i.useState([]),[ue,me]=i.useState([]),[ge,je]=i.useState(0),[pe,be]=i.useState(null),[fe,ve]=i.useState({open:!1,message:"",severity:"success"}),Ce=i.useCallback(async()=>{var e,r;j(!0);try{const t=await ye.adminGetProducts(s,l),i=(null==(e=t.data)?void 0:e.content)||[],n=(null==(r=t.data)?void 0:r.totalElements)||0;if(0===n&&0===s){const e=[{id:1,name:"iPhone 15 Pro",description:"Latest iPhone with advanced features",price:999.99,imageUrl:"https://images.unsplash.com/photo-1511707171634-5f897ff02aa9?w=400",category:"Phones",brand:"Apple",stockQuantity:12,rating:5,createdAt:"2024-01-01",updatedAt:"2024-01-01"},{id:2,name:"Samsung Galaxy S24",description:"Premium Android smartphone",price:899.99,imageUrl:"https://images.unsplash.com/photo-1511707171634-5f897ff02aa9?w=400",category:"Phones",brand:"Samsung",stockQuantity:8,rating:4.8,createdAt:"2024-01-01",updatedAt:"2024-01-01"}];a(e),u(e.length)}else a(i),u(n)}catch(t){Se("Error loading products","error")}finally{j(!1)}},[s,l]);i.useEffect(()=>{Ce()},[Ce,s,l]);const we=async e=>{if(!e)return xe([]);try{const a=(await ye.adminListProductImages(e)).data||[];xe(a)}catch(a){}},Se=(e,a)=>{ve({open:!0,message:e,severity:a})},Ne=i.useCallback(e=>{L(e),te(e),V(!0),we(e.id)},[]),Ee=i.useCallback(e=>{L(e),te({name:e.name,price:e.price,stockQuantity:e.stockQuantity,imageUrl:e.imageUrl,description:e.description,category:e.category,brand:e.brand,isOnSale:e.isOnSale||!1,salePrice:e.salePrice,saleStartAt:e.saleStartAt,saleEndAt:e.saleEndAt}),je(0),V(!0),we(e.id)},[]),Ie=i.useCallback(async e=>{b(e);try{const a=await ye.getProductVariants(e.id);v(a.data||[]),C(!0)}catch(a){Se("Error loading variants","error")}},[]),Pe=i.useCallback(e=>{L(e),H(!0)},[]),De=i.useMemo(()=>[{field:"id",headerName:"ID",width:80,renderCell:e=>r.jsx(x,{label:e.value,size:"small",color:"primary",variant:"outlined"})},{field:"name",headerName:"Product Name",flex:1.2,minWidth:200,renderCell:e=>r.jsxs(n,{children:[r.jsx(h,{variant:"body2",sx:{fontWeight:600},children:e.value}),r.jsx(h,{variant:"caption",color:"text.secondary",children:e.row.brand})]})},{field:"category",headerName:"Category",width:120,renderCell:e=>r.jsx(x,{label:e.value,size:"small",color:"secondary"})},{field:"isOnSale",headerName:"Sale",width:90,renderCell:e=>r.jsx(x,{label:e.value?"SALE":"‚Äî",size:"small",color:e.value?"error":"default",variant:e.value?"filled":"outlined"})},{field:"price",headerName:"Price",width:120,valueFormatter:e=>`$${Number(e.value).toFixed(2)}`,renderCell:e=>r.jsxs(h,{variant:"body2",sx:{fontWeight:700,color:"success.main"},children:["$",Number(e.value).toFixed(2)]})},{field:"stockQuantity",headerName:"Stock",width:100,renderCell:e=>r.jsx(x,{label:e.value,size:"small",color:e.value<10?"error":e.value<50?"warning":"success",variant:e.value<10?"filled":"outlined"})},{field:"isActive",headerName:"Status",width:100,valueFormatter:e=>e.value?"Active":"Inactive",renderCell:e=>r.jsx(x,{label:e.value?"Active":"Inactive",size:"small",color:e.value?"success":"default",variant:"outlined"})},{field:"actions",headerName:"Actions",width:280,sortable:!1,filterable:!1,renderCell:e=>r.jsxs(A,{direction:"row",spacing:1,children:[r.jsx(m,{size:"small",color:"info",onClick:()=>Ne(e.row),sx:{bgcolor:"info.50","&:hover":{bgcolor:"info.100"}},children:r.jsx(R,{fontSize:"small"})}),r.jsx(m,{size:"small",color:"primary",onClick:()=>Ee(e.row),sx:{bgcolor:"primary.50","&:hover":{bgcolor:"primary.100"}},children:r.jsx(W,{fontSize:"small"})}),r.jsx(m,{size:"small",color:"secondary",onClick:()=>Ie(e.row),sx:{bgcolor:"secondary.50","&:hover":{bgcolor:"secondary.100"}},title:"Manage Variants",children:r.jsx(N,{fontSize:"small"})}),r.jsx(m,{size:"small",color:"error",onClick:()=>Pe(e.row),sx:{bgcolor:"error.50","&:hover":{bgcolor:"error.100"}},children:r.jsx(ie,{fontSize:"small"})})]})}],[Ne,Ee,Ie,Pe]),ke=()=>{te({}),xe([]),me([]),be(null),je(0)};return r.jsxs(n,{children:[r.jsxs(n,{sx:{mb:4},children:[r.jsx(h,{variant:"h4",sx:{fontWeight:900,mb:1,background:"linear-gradient(45deg, #10b981 0%, #059669 100%)",backgroundClip:"text",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent"},children:"Product Management"}),r.jsx(h,{variant:"body1",color:"text.secondary",children:"Manage your product catalog, inventory, and pricing"})]}),r.jsxs(O,{container:!0,spacing:3,sx:{mb:4},children:[r.jsx(O,{item:!0,xs:12,sm:6,md:3,children:r.jsx(M,{sx:{height:"100%",background:"linear-gradient(135deg, #10b981 0%, #059669 100%)",color:"white"},children:r.jsx(U,{children:r.jsxs(n,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[r.jsxs(n,{children:[r.jsx(h,{variant:"h4",sx:{fontWeight:900,mb:1},children:d}),r.jsx(h,{variant:"body2",sx:{opacity:.9},children:"Total Products"})]}),r.jsx(N,{sx:{fontSize:40,opacity:.8}})]})})})}),r.jsx(O,{item:!0,xs:12,sm:6,md:3,children:r.jsx(M,{sx:{height:"100%",background:"linear-gradient(135deg, #3b82f6 0%, #2563eb 100%)",color:"white"},children:r.jsx(U,{children:r.jsxs(n,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[r.jsxs(n,{children:[r.jsx(h,{variant:"h4",sx:{fontWeight:900,mb:1},children:e.filter(e=>e.stockQuantity<10).length}),r.jsx(h,{variant:"body2",sx:{opacity:.9},children:"Low Stock"})]}),r.jsx(G,{sx:{fontSize:40,opacity:.8}})]})})})}),r.jsx(O,{item:!0,xs:12,sm:6,md:3,children:r.jsx(M,{sx:{height:"100%",background:"linear-gradient(135deg, #f59e0b 0%, #d97706 100%)",color:"white"},children:r.jsx(U,{children:r.jsxs(n,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[r.jsxs(n,{children:[r.jsx(h,{variant:"h4",sx:{fontWeight:900,mb:1},children:e.filter(e=>e.isActive).length}),r.jsx(h,{variant:"body2",sx:{opacity:.9},children:"Active Products"})]}),r.jsx(le,{sx:{fontSize:40,opacity:.8}})]})})})}),r.jsx(O,{item:!0,xs:12,sm:6,md:3,children:r.jsx(M,{sx:{height:"100%",background:"linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%)",color:"white"},children:r.jsx(U,{children:r.jsxs(n,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[r.jsxs(n,{children:[r.jsx(h,{variant:"h4",sx:{fontWeight:900,mb:1},children:new Set(e.map(e=>e.brand)).size}),r.jsx(h,{variant:"body2",sx:{opacity:.9},children:"Brands"})]}),r.jsx(c,{sx:{fontSize:40,opacity:.8}})]})})})})]}),r.jsx(M,{sx:{borderRadius:3,boxShadow:"0 8px 32px rgba(0,0,0,0.08)"},children:r.jsxs(U,{children:[r.jsxs(n,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:[r.jsx(h,{variant:"h6",sx:{fontWeight:700},children:"Product List"}),r.jsxs(A,{direction:"row",spacing:2,children:[r.jsx(Y,{variant:"contained",startIcon:r.jsx(ne,{}),onClick:()=>{ke(),Z(!0)},sx:{bgcolor:"success.main","&:hover":{bgcolor:"success.dark"},borderRadius:2,px:3,py:1},children:"Add Product"}),r.jsx(Y,{variant:"outlined",startIcon:r.jsx(N,{}),onClick:async()=>{try{const e=(await ye.adminFixAllProductStock()).data;Se(`Stock fixed! Updated ${e.updatedProducts} out of ${e.totalProducts} products`,"success"),await Ce()}catch(e){Se("Error fixing product stock","error")}},sx:{borderColor:"warning.main",color:"warning.main","&:hover":{borderColor:"warning.dark",color:"warning.dark",bgcolor:"warning.50"},borderRadius:2,px:3,py:1},children:"Fix All Stock"})]})]}),r.jsx(n,{sx:{height:600,width:"100%"},children:r.jsx(_,{rows:e,columns:De,pagination:!0,paginationMode:"server",rowCount:d,pageSizeOptions:[10,25,50],paginationModel:{page:s,pageSize:l},onPaginationModelChange:e=>{t(e.page),o(e.pageSize)},loading:g,getRowId:e=>e.id,sx:{border:"none","& .MuiDataGrid-cell":{borderBottom:"1px solid #f0f0f0"},"& .MuiDataGrid-columnHeaders":{bgcolor:"#f8fafc",borderBottom:"2px solid #e2e8f0"},"& .MuiDataGrid-row:hover":{bgcolor:"#f8fafc"}}})})]})}),r.jsxs(B,{open:T,onClose:()=>V(!1),maxWidth:"md",fullWidth:!0,children:[r.jsxs(q,{sx:{bgcolor:"primary.main",color:"white",display:"flex",alignItems:"center",gap:1},children:[r.jsx(W,{}),"Edit Product"]}),r.jsxs(Q,{sx:{pt:3},children:[r.jsxs(O,{container:!0,spacing:3,children:[r.jsxs(O,{item:!0,xs:12,md:6,children:[r.jsx(J,{fullWidth:!0,label:"Product Name",value:re.name||"",onChange:e=>te({...re,name:e.target.value}),sx:{mb:2}}),r.jsx(J,{fullWidth:!0,label:"Brand",value:re.brand||"",onChange:e=>te({...re,brand:e.target.value}),sx:{mb:2}}),r.jsx(J,{fullWidth:!0,label:"Category",value:re.category||"",onChange:e=>te({...re,category:e.target.value}),sx:{mb:2}})]}),r.jsxs(O,{item:!0,xs:12,md:6,children:[r.jsx(J,{fullWidth:!0,label:"Price",type:"number",value:re.price||"",onChange:e=>te({...re,price:Number(e.target.value)}),sx:{mb:2}}),r.jsx(oe,{control:r.jsx(de,{checked:Boolean(re.isOnSale),onChange:e=>te({...re,isOnSale:e.target.checked})}),label:"On Sale"}),r.jsx(J,{fullWidth:!0,label:"Discount (%)",type:"number",value:re.saleDiscountPercent||"",onChange:e=>{const a=Math.max(0,Math.min(100,Number(e.target.value))),s=re.price?Number((Number(re.price)*(1-a/100)).toFixed(2)):void 0;te({...re,salePrice:s,...isNaN(a)?{}:{saleDiscountPercent:a}})},sx:{mb:1,mt:1},disabled:!re.isOnSale,helperText:null!=re.price&&null!=re.saleDiscountPercent?`Gi√° sau gi·∫£m: $${(Number(re.price)*(1-(Number(re.saleDiscountPercent)||0)/100)).toFixed(2)}`:""}),r.jsx(J,{fullWidth:!0,label:"Sale Start (datetime)",type:"datetime-local",value:re.saleStartAt||"",onChange:e=>te({...re,saleStartAt:e.target.value}),sx:{mb:2},disabled:!re.isOnSale,InputLabelProps:{shrink:!0}}),r.jsx(J,{fullWidth:!0,label:"Sale End (datetime)",type:"datetime-local",value:re.saleEndAt||"",onChange:e=>te({...re,saleEndAt:e.target.value}),sx:{mb:2},disabled:!re.isOnSale,InputLabelProps:{shrink:!0}}),r.jsx(J,{fullWidth:!0,label:"Stock Quantity",type:"number",value:re.stockQuantity||"",onChange:e=>te({...re,stockQuantity:Number(e.target.value)}),sx:{mb:2}}),r.jsx(J,{fullWidth:!0,label:"·∫¢nh Ch√≠nh (Main Image URL)",value:re.imageUrl||"",onChange:e=>te({...re,imageUrl:e.target.value}),sx:{mb:2},helperText:"URL ·∫£nh hi·ªÉn th·ªã tr√™n danh s√°ch s·∫£n ph·∫©m"}),r.jsx(J,{fullWidth:!0,label:"Nh·∫≠p Th√™m H√†ng",type:"number",value:ge,onChange:e=>je(Number(e.target.value)),sx:{mb:2},helperText:`Hi·ªán t·∫°i: ${re.stockQuantity||0} s·∫£n ph·∫©m. Nh·∫≠p s·ªë l∆∞·ª£ng mu·ªën th√™m v√†o kho.`,InputProps:{startAdornment:r.jsx(n,{sx:{mr:1,display:"flex",alignItems:"center"},children:r.jsx(N,{fontSize:"small",color:"primary"})})}})]}),r.jsx(O,{item:!0,xs:12,children:r.jsx(J,{fullWidth:!0,label:"Description",value:re.description||"",multiline:!0,rows:3,onChange:e=>te({...re,description:e.target.value}),sx:{mb:2}})})]}),k&&r.jsxs(n,{sx:{mt:3},children:[r.jsx(h,{variant:"subtitle1",sx:{mb:2,fontWeight:600},children:"Product Images"}),r.jsx(A,{direction:"row",spacing:2,alignItems:"center",sx:{mb:2},children:r.jsxs(Y,{variant:"outlined",component:"label",startIcon:r.jsx(ce,{}),children:["Upload Images",r.jsx("input",{hidden:!0,multiple:!0,type:"file",accept:"image/*",onChange:async e=>{const a=Array.from(e.target.files||[]);if(a.length&&(null==k?void 0:k.id))try{await ye.adminUploadProductImages(k.id,a),await we(k.id),Se("Images uploaded successfully","success")}catch(s){Se("Error uploading images","error")}}})]})}),r.jsx(O,{container:!0,spacing:2,children:he.map(e=>r.jsx(O,{item:!0,children:r.jsxs(K,{sx:{p:1,position:"relative"},children:[r.jsx("img",{src:e.imageUrl,alt:"product",style:{width:80,height:80,objectFit:"cover",borderRadius:8}}),r.jsx(m,{size:"small",color:"error",sx:{position:"absolute",top:-8,right:-8,bgcolor:"error.main",color:"white","&:hover":{bgcolor:"error.dark"}},onClick:async()=>{try{await ye.adminDeleteProductImage(k.id,e.id),await we(k.id),Se("Image deleted successfully","success")}catch(a){Se("Error deleting image","error")}},children:r.jsx(ie,{fontSize:"small"})})]})},e.id))})]})]}),r.jsxs(X,{sx:{p:3,pt:2},children:[r.jsx(Y,{onClick:()=>V(!1),startIcon:r.jsx(z,{}),children:"Cancel"}),r.jsx(Y,{variant:"contained",onClick:async()=>{if(k)try{await ye.adminUpdateProduct(k.id,re),ge>0?(await ye.adminRestockProduct(k.id,ge),Se(`Product updated and restocked with ${ge} units`,"success")):Se("Product updated successfully","success"),V(!1),je(0),await Ce()}catch(e){Se("Error updating product","error")}},startIcon:r.jsx(ee,{}),children:"Save Changes"})]})]}),r.jsxs(B,{open:$,onClose:()=>Z(!1),maxWidth:"md",fullWidth:!0,children:[r.jsxs(q,{sx:{bgcolor:"success.main",color:"white",display:"flex",alignItems:"center",gap:1},children:[r.jsx(ne,{}),"Create New Product"]}),r.jsxs(Q,{sx:{pt:3},children:[r.jsxs(O,{container:!0,spacing:3,children:[r.jsxs(O,{item:!0,xs:12,md:6,children:[r.jsx(J,{fullWidth:!0,label:"Product Name",value:re.name||"",onChange:e=>te({...re,name:e.target.value}),sx:{mb:2}}),r.jsx(J,{fullWidth:!0,label:"Brand",value:re.brand||"",onChange:e=>te({...re,brand:e.target.value}),sx:{mb:2}}),r.jsx(J,{fullWidth:!0,label:"Category",value:re.category||"",onChange:e=>te({...re,category:e.target.value}),sx:{mb:2}})]}),r.jsxs(O,{item:!0,xs:12,md:6,children:[r.jsx(J,{fullWidth:!0,label:"Price",type:"number",value:re.price||"",onChange:e=>te({...re,price:Number(e.target.value)}),sx:{mb:2}}),r.jsx(oe,{control:r.jsx(de,{checked:Boolean(re.isOnSale),onChange:e=>te({...re,isOnSale:e.target.checked})}),label:"On Sale"}),r.jsx(J,{fullWidth:!0,label:"Discount (%)",type:"number",value:re.saleDiscountPercent||"",onChange:e=>{const a=Math.max(0,Math.min(100,Number(e.target.value))),s=re.price?Number((Number(re.price)*(1-a/100)).toFixed(2)):void 0;te({...re,salePrice:s,...isNaN(a)?{}:{saleDiscountPercent:a}})},sx:{mb:1,mt:1},disabled:!re.isOnSale,helperText:null!=re.price&&null!=re.saleDiscountPercent?`Gi√° sau gi·∫£m: $${(Number(re.price)*(1-(Number(re.saleDiscountPercent)||0)/100)).toFixed(2)}`:""}),r.jsx(J,{fullWidth:!0,label:"Sale Start (datetime)",type:"datetime-local",value:re.saleStartAt||"",onChange:e=>te({...re,saleStartAt:e.target.value}),sx:{mb:2},disabled:!re.isOnSale,InputLabelProps:{shrink:!0}}),r.jsx(J,{fullWidth:!0,label:"Sale End (datetime)",type:"datetime-local",value:re.saleEndAt||"",onChange:e=>te({...re,saleEndAt:e.target.value}),sx:{mb:2},disabled:!re.isOnSale,InputLabelProps:{shrink:!0}}),r.jsx(J,{fullWidth:!0,label:"Stock Quantity",type:"number",value:re.stockQuantity||"",onChange:e=>te({...re,stockQuantity:Number(e.target.value)}),sx:{mb:2}}),r.jsxs(n,{sx:{mb:2},children:[r.jsx(h,{variant:"body2",sx:{mb:1,fontWeight:600},children:"·∫¢nh Ch√≠nh (Main Image)"}),r.jsxs(Y,{variant:"outlined",component:"label",startIcon:r.jsx(ce,{}),sx:{mb:1},children:["Ch·ªçn ·∫¢nh Ch√≠nh",r.jsx("input",{hidden:!0,type:"file",accept:"image/*",onChange:e=>{var a;const s=null==(a=e.target.files)?void 0:a[0];s&&be(s)}})]}),r.jsx(h,{variant:"caption",display:"block",color:"text.secondary",children:"·∫¢nh hi·ªÉn th·ªã tr√™n danh s√°ch s·∫£n ph·∫©m (ch·ªâ ch·ªçn 1 ·∫£nh)"}),pe&&r.jsx(n,{sx:{mt:1},children:r.jsxs(K,{sx:{p:1,display:"inline-block",position:"relative"},children:[r.jsx("img",{src:URL.createObjectURL(pe),alt:"main-preview",style:{width:100,height:100,objectFit:"cover",borderRadius:8}}),r.jsx(m,{size:"small",color:"error",sx:{position:"absolute",top:-8,right:-8,bgcolor:"error.main",color:"white","&:hover":{bgcolor:"error.dark"}},onClick:()=>be(null),children:r.jsx(ie,{fontSize:"small"})})]})})]})]}),r.jsx(O,{item:!0,xs:12,children:r.jsx(J,{fullWidth:!0,label:"Description",value:re.description||"",multiline:!0,rows:3,onChange:e=>te({...re,description:e.target.value}),sx:{mb:2}})})]}),r.jsxs(n,{sx:{mt:3},children:[r.jsx(h,{variant:"subtitle1",sx:{mb:2,fontWeight:600},children:"·∫¢nh Chi Ti·∫øt S·∫£n Ph·∫©m (Gallery)"}),r.jsxs(Y,{variant:"outlined",component:"label",startIcon:r.jsx(ce,{}),children:["Upload Images",r.jsx("input",{hidden:!0,multiple:!0,type:"file",accept:"image/*",onChange:e=>{const a=Array.from(e.target.files||[]);me(a)}})]}),ue.length>0&&r.jsx(O,{container:!0,spacing:2,sx:{mt:2},children:ue.map((e,a)=>r.jsx(O,{item:!0,children:r.jsxs(K,{sx:{p:1,position:"relative"},children:[r.jsx("img",{src:URL.createObjectURL(e),alt:`new-${a}`,style:{width:80,height:80,objectFit:"cover",borderRadius:8}}),r.jsx(m,{size:"small",color:"error",sx:{position:"absolute",top:-8,right:-8,bgcolor:"error.main",color:"white","&:hover":{bgcolor:"error.dark"}},onClick:()=>me(ue.filter((e,s)=>s!==a)),children:r.jsx(ie,{fontSize:"small"})})]})},a))})]})]}),r.jsxs(X,{sx:{p:3,pt:2},children:[r.jsx(Y,{onClick:()=>Z(!1),startIcon:r.jsx(z,{}),children:"Cancel"}),r.jsx(Y,{variant:"contained",onClick:async()=>{try{let e="";if(pe){e=(await ye.adminUploadImage(pe)).data.url}const a={...re,imageUrl:e},s=(await ye.adminCreateProduct(a)).data;ue.length>0&&s.id&&await ye.adminUploadProductImages(s.id,ue),Z(!1),ke(),await Ce(),Se("Product created successfully","success")}catch(e){Se("Error creating product","error")}},startIcon:r.jsx(ee,{}),children:"Create Product"})]})]}),r.jsxs(B,{open:F,onClose:()=>H(!1),children:[r.jsx(q,{sx:{color:"error.main"},children:"Delete Product?"}),r.jsx(Q,{children:r.jsxs(h,{children:['Are you sure you want to delete "',null==k?void 0:k.name,'"? This action cannot be undone.']})}),r.jsxs(X,{children:[r.jsx(Y,{onClick:()=>H(!1),children:"Cancel"}),r.jsx(Y,{color:"error",variant:"contained",onClick:async()=>{if(k)try{await ye.adminDeleteProduct(k.id),H(!1),await Ce(),Se("Product deleted successfully","success")}catch(e){Se("Error deleting product","error")}},children:"Delete"})]})]}),r.jsx(ae,{open:fe.open,autoHideDuration:6e3,onClose:()=>ve({...fe,open:!1}),children:r.jsx(se,{onClose:()=>ve({...fe,open:!1}),severity:fe.severity,sx:{width:"100%"},children:fe.message})}),r.jsxs(B,{open:y,onClose:()=>C(!1),maxWidth:"lg",fullWidth:!0,children:[r.jsx(q,{children:r.jsxs(h,{variant:"h6",sx:{fontWeight:"bold"},children:["Manage Variants - ",null==p?void 0:p.name]})}),r.jsxs(Q,{children:[r.jsxs(n,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[r.jsxs(h,{variant:"subtitle1",children:["Product Variants (",f.length,")"]}),r.jsx(Y,{variant:"contained",startIcon:r.jsx(ne,{}),onClick:()=>{I(null),D({variantName:"",sku:"",color:"",size:"",price:(null==p?void 0:p.price)||0,stockQuantity:0,isActive:!0,isDefault:!1}),S(!0)},size:"small",children:"Add Variant"})]}),r.jsx(_,{rows:f,columns:[{field:"variantName",headerName:"Name",width:150},{field:"sku",headerName:"SKU",width:120},{field:"color",headerName:"Color",width:100},{field:"size",headerName:"Size",width:100},{field:"price",headerName:"Price",width:100,type:"number"},{field:"stockQuantity",headerName:"Stock",width:100,type:"number"},{field:"isDefault",headerName:"Default",width:100,renderCell:e=>r.jsx(x,{label:e.value?"Yes":"No",color:e.value?"primary":"default",size:"small"})},{field:"actions",headerName:"Actions",width:120,renderCell:e=>r.jsxs(A,{direction:"row",spacing:1,children:[r.jsx(m,{size:"small",color:"primary",onClick:()=>{return a=e.row,I(a),D(a),void S(!0);var a},children:r.jsx(W,{fontSize:"small"})}),r.jsx(m,{size:"small",color:"error",onClick:()=>(async e=>{if(window.confirm("Are you sure you want to delete this variant?"))try{await ye.deleteVariant(e),Se("Variant deleted successfully","success");const a=await ye.getProductVariants(p.id);v(a.data||[])}catch(a){Se("Error deleting variant","error")}})(e.row.id),children:r.jsx(ie,{fontSize:"small"})})]})}],pageSizeOptions:[5,10,25],initialState:{pagination:{paginationModel:{pageSize:10}}},disableRowSelectionOnClick:!0,autoHeight:!0})]}),r.jsx(X,{children:r.jsx(Y,{onClick:()=>C(!1),children:"Close"})})]}),r.jsxs(B,{open:w,onClose:()=>S(!1),maxWidth:"md",fullWidth:!0,children:[r.jsx(q,{children:r.jsx(h,{variant:"h6",sx:{fontWeight:"bold"},children:E?"Edit Variant":"Add New Variant"})}),r.jsx(Q,{children:r.jsxs(O,{container:!0,spacing:2,sx:{mt:1},children:[r.jsx(O,{item:!0,xs:12,sm:6,children:r.jsx(J,{fullWidth:!0,label:"Variant Name",value:P.variantName||"",onChange:e=>D(a=>({...a,variantName:e.target.value})),required:!0})}),r.jsx(O,{item:!0,xs:12,sm:6,children:r.jsx(J,{fullWidth:!0,label:"SKU",value:P.sku||"",onChange:e=>D(a=>({...a,sku:e.target.value})),required:!0})}),r.jsx(O,{item:!0,xs:12,sm:6,children:r.jsx(J,{fullWidth:!0,label:"Color",value:P.color||"",onChange:e=>D(a=>({...a,color:e.target.value}))})}),r.jsx(O,{item:!0,xs:12,sm:6,children:r.jsx(J,{fullWidth:!0,label:"Size",value:P.size||"",onChange:e=>D(a=>({...a,size:e.target.value}))})}),r.jsx(O,{item:!0,xs:12,sm:6,children:r.jsx(J,{fullWidth:!0,label:"Price",type:"number",value:P.price||0,onChange:e=>D(a=>({...a,price:Number(e.target.value)})),required:!0})}),r.jsx(O,{item:!0,xs:12,sm:6,children:r.jsx(J,{fullWidth:!0,label:"Stock Quantity",type:"number",value:P.stockQuantity||0,onChange:e=>D(a=>({...a,stockQuantity:Number(e.target.value)})),required:!0})}),r.jsx(O,{item:!0,xs:12,sm:6,children:r.jsx(J,{fullWidth:!0,label:"Image URL",value:P.imageUrl||"",onChange:e=>D(a=>({...a,imageUrl:e.target.value}))})}),r.jsx(O,{item:!0,xs:12,sm:6,children:r.jsx(J,{fullWidth:!0,label:"Barcode",value:P.barcode||"",onChange:e=>D(a=>({...a,barcode:e.target.value}))})}),r.jsx(O,{item:!0,xs:12,children:r.jsx(oe,{control:r.jsx(de,{checked:P.isActive||!1,onChange:e=>D(a=>({...a,isActive:e.target.checked}))}),label:"Active"})}),r.jsx(O,{item:!0,xs:12,children:r.jsx(oe,{control:r.jsx(de,{checked:P.isDefault||!1,onChange:e=>D(a=>({...a,isDefault:e.target.checked}))}),label:"Default Variant"})})]})}),r.jsxs(X,{children:[r.jsx(Y,{onClick:()=>S(!1),children:"Cancel"}),r.jsx(Y,{variant:"contained",onClick:async()=>{try{E?(await ye.updateVariant(E.id,P),Se("Variant updated successfully","success")):(await ye.createVariant(p.id,P),Se("Variant created successfully","success"));const e=await ye.getProductVariants(p.id);v(e.data||[]),S(!1)}catch(e){Se("Error saving variant","error")}},children:E?"Update":"Create"})]})]})]})},Ee=()=>{const[e,a]=i.useState([]),[s,t]=i.useState(0),[l,o]=i.useState(10),[d,c]=i.useState(0),[g,j]=i.useState(!1),[p,b]=i.useState(null),[f,v]=i.useState(!1),[y,C]=i.useState(!1),[w,N]=i.useState({}),[I,P]=i.useState(""),[D,k]=i.useState({open:!1,message:"",severity:"success"}),L=async()=>{j(!0);try{const e=(await ye.getUsers()).data||[];a(e),c(e.length),Ce.info("T·∫£i danh s√°ch ng∆∞·ªùi d√πng th√†nh c√¥ng",{duration:2e3})}catch(e){T("Error loading users","error"),Ce.error("Kh√¥ng th·ªÉ t·∫£i danh s√°ch ng∆∞·ªùi d√πng")}finally{j(!1)}};i.useEffect(()=>{L()},[]),i.useEffect(()=>{},[e]);const T=(e,a)=>{k({open:!0,message:e,severity:a})},G=e=>{switch(e){case"ADMIN":return"error";case"MODERATOR":return"warning";case"REPAIR_TECHNICIAN":return"info";default:return"default"}},K=e=>{switch(e){case"ADMIN":return r.jsx(ue,{fontSize:"small"});case"MODERATOR":return r.jsx(he,{fontSize:"small"});case"REPAIR_TECHNICIAN":return r.jsx(S,{fontSize:"small"});default:return r.jsx(ge,{fontSize:"small"})}},Z=i.useMemo(()=>[{field:"id",headerName:"ID",width:80,renderCell:e=>r.jsx(x,{label:e.value,size:"small",color:"primary",variant:"outlined"})},{field:"avatar",headerName:"Avatar",width:80,renderCell:e=>{var a,s;return r.jsx(u,{src:e.value,sx:{width:40,height:40},children:(null==(a=e.row.firstName)?void 0:a.charAt(0))||(null==(s=e.row.username)?void 0:s.charAt(0))||"U"})}},{field:"username",headerName:"Username",flex:1,minWidth:150,renderCell:e=>r.jsxs(n,{children:[r.jsx(h,{variant:"body2",sx:{fontWeight:600},children:e.value}),r.jsxs(h,{variant:"caption",color:"text.secondary",children:["ID: ",e.row.id]})]})},{field:"email",headerName:"Email",flex:1.2,minWidth:200,renderCell:e=>r.jsx(h,{variant:"body2",sx:{fontFamily:"monospace",fontSize:"0.85rem"},children:e.value})},{field:"fullName",headerName:"Full Name",width:160,valueGetter:e=>`${e.row.firstName||""} ${e.row.lastName||""}`.trim()||"N/A",renderCell:e=>r.jsx(h,{variant:"body2",sx:{fontWeight:500},children:e.value})},{field:"role",headerName:"Role",width:120,renderCell:e=>r.jsx(x,{label:e.value,size:"small",color:G(e.value),icon:K(e.value),variant:"outlined"})},{field:"isEmailVerified",headerName:"Verified",width:110,renderCell:e=>r.jsx(x,{label:e.value?"Yes":"No",size:"small",color:e.value?"success":"default",icon:e.value?r.jsx(he,{}):r.jsx(xe,{}),variant:"outlined"})},{field:"actions",headerName:"Actions",width:260,sortable:!1,filterable:!1,renderCell:e=>r.jsxs(A,{direction:"row",spacing:1,children:[r.jsx(m,{size:"small",color:"info",onClick:()=>re(e.row),sx:{bgcolor:"info.50","&:hover":{bgcolor:"info.100"}},children:r.jsx(R,{fontSize:"small"})}),r.jsx(m,{size:"small",color:"primary",onClick:()=>te(e.row),sx:{bgcolor:"primary.50","&:hover":{bgcolor:"primary.100"}},children:r.jsx(W,{fontSize:"small"})}),r.jsx(m,{size:"small",color:"error",onClick:()=>le(e.row),sx:{bgcolor:"error.50","&:hover":{bgcolor:"error.100"}},children:r.jsx(ie,{fontSize:"small"})})]})}],[]),re=e=>{b(e),N(e),v(!0)},te=e=>{b(e),N({firstName:e.firstName,lastName:e.lastName,email:e.email,phoneNumber:e.phoneNumber,role:e.role,isEmailVerified:e.isEmailVerified}),v(!0)},le=e=>{b(e),C(!0)};return r.jsxs(n,{children:[r.jsxs(n,{sx:{mb:4},children:[r.jsx(h,{variant:"h4",sx:{fontWeight:900,mb:1,background:"linear-gradient(45deg, #3b82f6 0%, #2563eb 100%)",backgroundClip:"text",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent"},children:"User Management"}),r.jsx(h,{variant:"body1",color:"text.secondary",children:"Manage user accounts, roles, and permissions"})]}),r.jsxs(O,{container:!0,spacing:3,sx:{mb:4},children:[r.jsx(O,{item:!0,xs:12,sm:6,md:3,children:r.jsx(M,{sx:{height:"100%",background:"linear-gradient(135deg, #3b82f6 0%, #2563eb 100%)",color:"white"},children:r.jsx(U,{children:r.jsxs(n,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[r.jsxs(n,{children:[r.jsx(h,{variant:"h4",sx:{fontWeight:900,mb:1},children:d}),r.jsx(h,{variant:"body2",sx:{opacity:.9},children:"Total Users"})]}),r.jsx(E,{sx:{fontSize:40,opacity:.8}})]})})})}),r.jsx(O,{item:!0,xs:12,sm:6,md:3,children:r.jsx(M,{sx:{height:"100%",background:"linear-gradient(135deg, #10b981 0%, #059669 100%)",color:"white"},children:r.jsx(U,{children:r.jsxs(n,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[r.jsxs(n,{children:[r.jsx(h,{variant:"h4",sx:{fontWeight:900,mb:1},children:e.filter(e=>e.isEmailVerified).length}),r.jsx(h,{variant:"body2",sx:{opacity:.9},children:"Verified Users"})]}),r.jsx(he,{sx:{fontSize:40,opacity:.8}})]})})})}),r.jsx(O,{item:!0,xs:12,sm:6,md:3,children:r.jsx(M,{sx:{height:"100%",background:"linear-gradient(135deg, #f59e0b 0%, #d97706 100%)",color:"white"},children:r.jsx(U,{children:r.jsxs(n,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[r.jsxs(n,{children:[r.jsx(h,{variant:"h4",sx:{fontWeight:900,mb:1},children:e.filter(e=>"ADMIN"===e.role).length}),r.jsx(h,{variant:"body2",sx:{opacity:.9},children:"Admin Users"})]}),r.jsx(ue,{sx:{fontSize:40,opacity:.8}})]})})})}),r.jsx(O,{item:!0,xs:12,sm:6,md:3,children:r.jsx(M,{sx:{height:"100%",background:"linear-gradient(135deg, #06b6d4 0%, #0891b2 100%)",color:"white"},children:r.jsx(U,{children:r.jsxs(n,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[r.jsxs(n,{children:[r.jsx(h,{variant:"h4",sx:{fontWeight:900,mb:1},children:e.filter(e=>"REPAIR_TECHNICIAN"===e.role).length}),r.jsx(h,{variant:"body2",sx:{opacity:.9},children:"Repair Technicians"})]}),r.jsx(S,{sx:{fontSize:40,opacity:.8}})]})})})}),r.jsx(O,{item:!0,xs:12,sm:6,md:3,children:r.jsx(M,{sx:{height:"100%",background:"linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%)",color:"white"},children:r.jsx(U,{children:r.jsxs(n,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[r.jsxs(n,{children:[r.jsx(h,{variant:"h4",sx:{fontWeight:900,mb:1},children:e.filter(e=>!e.isEmailVerified).length}),r.jsx(h,{variant:"body2",sx:{opacity:.9},children:"Unverified Users"})]}),r.jsx(xe,{sx:{fontSize:40,opacity:.8}})]})})})})]}),r.jsx(M,{sx:{borderRadius:3,boxShadow:"0 8px 32px rgba(0,0,0,0.08)"},children:r.jsxs(U,{children:[r.jsxs(n,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:[r.jsx(h,{variant:"h6",sx:{fontWeight:700},children:"User List"}),r.jsx(Y,{variant:"contained",startIcon:r.jsx(me,{}),onClick:()=>{N({}),b(null),v(!0)},sx:{bgcolor:"primary.main","&:hover":{bgcolor:"primary.dark"},borderRadius:2,px:3,py:1},children:"Add User"})]}),r.jsx(n,{sx:{height:600,width:"100%"},children:r.jsx(_,{rows:e,columns:Z,pagination:!0,paginationMode:"client",pageSizeOptions:[10,25,50],paginationModel:{page:s,pageSize:l},onPaginationModelChange:e=>{t(e.page),o(e.pageSize)},loading:g,getRowId:e=>e.id,sx:{border:"none","& .MuiDataGrid-cell":{borderBottom:"1px solid #f0f0f0"},"& .MuiDataGrid-columnHeaders":{bgcolor:"#f8fafc",borderBottom:"2px solid #e2e8f0"},"& .MuiDataGrid-row:hover":{bgcolor:"#f8fafc"}}})})]})}),r.jsxs(B,{open:f,onClose:()=>v(!1),maxWidth:"md",fullWidth:!0,children:[r.jsxs(q,{sx:{bgcolor:p?"primary.main":"success.main",color:"white",display:"flex",alignItems:"center",gap:1},children:[p?r.jsx(W,{}):r.jsx(me,{}),p?"Edit User":"Create New User"]}),r.jsx(Q,{sx:{pt:3},children:r.jsxs(O,{container:!0,spacing:3,children:[r.jsxs(O,{item:!0,xs:12,md:6,children:[r.jsx(J,{fullWidth:!0,label:"First Name",value:w.firstName||"",onChange:e=>N({...w,firstName:e.target.value}),sx:{mb:2}}),r.jsx(J,{fullWidth:!0,label:"Last Name",value:w.lastName||"",onChange:e=>N({...w,lastName:e.target.value}),sx:{mb:2}}),r.jsx(J,{fullWidth:!0,label:"Email",type:"email",value:w.email||"",onChange:e=>N({...w,email:e.target.value}),sx:{mb:2}}),!p&&r.jsxs(r.Fragment,{children:[r.jsx(J,{fullWidth:!0,label:"Username",value:w.username||"",onChange:e=>N({...w,username:e.target.value}),sx:{mb:2}}),r.jsx(J,{fullWidth:!0,label:"Password",type:"password",value:w.password||"",onChange:e=>N({...w,password:e.target.value}),sx:{mb:2}})]})]}),r.jsxs(O,{item:!0,xs:12,md:6,children:[r.jsx(J,{fullWidth:!0,label:"Phone Number",value:w.phoneNumber||"",onChange:e=>N({...w,phoneNumber:e.target.value}),sx:{mb:2}}),r.jsxs(V,{fullWidth:!0,sx:{mb:2},children:[r.jsx(F,{children:"Role"}),r.jsxs(H,{value:w.role||"USER",label:"Role",onChange:e=>N({...w,role:e.target.value}),children:[r.jsx($,{value:"USER",children:"User"}),r.jsx($,{value:"MODERATOR",children:"Moderator"}),r.jsx($,{value:"REPAIR_TECHNICIAN",children:"Repair Technician"}),r.jsx($,{value:"ADMIN",children:"Admin"})]})]}),r.jsx(oe,{control:r.jsx(de,{checked:w.isEmailVerified||!1,onChange:e=>N({...w,isEmailVerified:e.target.checked})}),label:"Email Verified"}),p&&r.jsx(J,{fullWidth:!0,label:"New Password (optional)",type:"password",value:w.password||"",onChange:e=>N({...w,password:e.target.value}),sx:{mt:2}})]}),r.jsx(O,{item:!0,xs:12,children:r.jsx(J,{fullWidth:!0,label:"L√Ω do thay ƒë·ªïi quy·ªÅn h·∫°n (n·∫øu c√≥)",value:I,onChange:e=>P(e.target.value),placeholder:"Nh·∫≠p l√Ω do thay ƒë·ªïi quy·ªÅn h·∫°n...",multiline:!0,rows:2})})]})}),r.jsxs(X,{sx:{p:3,pt:2},children:[r.jsx(Y,{onClick:()=>v(!1),startIcon:r.jsx(z,{}),children:"Cancel"}),r.jsx(Y,{variant:"contained",onClick:async()=>{try{if(p){const e={...w};I.trim()&&(e.reason=I.trim());const s={...p,...e};a(e=>e.map(e=>e.id===p.id?s:e));await ye.adminUpdateUser(p.id,e);T("User updated successfully","success"),Ce.success("C·∫≠p nh·∫≠t ng∆∞·ªùi d√πng th√†nh c√¥ng")}else{const e={...w};if(!e.username||!e.password||!w.email)return T("Username, password and email are required","warning"),void Ce.warning("Thi·∫øu Username/Password/Email");await ye.adminCreateUser(e);T("User created successfully","success"),Ce.success("T·∫°o ng∆∞·ªùi d√πng m·ªõi th√†nh c√¥ng")}v(!1),P(""),await L()}catch(e){T("Error saving user","error"),Ce.error("L∆∞u ng∆∞·ªùi d√πng th·∫•t b·∫°i"),p&&await L()}},startIcon:r.jsx(ee,{}),children:p?"Save Changes":"Create User"})]})]}),r.jsxs(B,{open:y,onClose:()=>C(!1),children:[r.jsx(q,{sx:{color:"error.main"},children:"Delete User?"}),r.jsx(Q,{children:r.jsxs(h,{children:['Are you sure you want to delete user "',null==p?void 0:p.username,'"? This action cannot be undone.']})}),r.jsxs(X,{children:[r.jsx(Y,{onClick:()=>C(!1),children:"Cancel"}),r.jsx(Y,{color:"error",variant:"contained",onClick:async()=>{if(p)try{await ye.adminDeleteUser(p.id),C(!1),await L(),T("User deleted successfully","success"),Ce.success("X√≥a ng∆∞·ªùi d√πng th√†nh c√¥ng")}catch(e){T("Error deleting user","error"),Ce.error("X√≥a ng∆∞·ªùi d√πng th·∫•t b·∫°i")}},children:"Delete"})]})]}),r.jsx(ae,{open:D.open,autoHideDuration:6e3,onClose:()=>k({...D,open:!1}),children:r.jsx(se,{onClose:()=>k({...D,open:!1}),severity:D.severity,sx:{width:"100%"},children:D.message})})]})},Ie=()=>r.jsx(M,{sx:{borderRadius:3},children:r.jsxs(U,{children:[r.jsx(h,{variant:"h5",sx:{fontWeight:"bold",mb:2},children:"Vouchers"}),r.jsx(h,{variant:"body2",color:"text.secondary",children:"Voucher management module (to be implemented)."})]})}),Pe=()=>r.jsx(M,{sx:{borderRadius:3},children:r.jsxs(U,{children:[r.jsx(h,{variant:"h5",sx:{fontWeight:"bold",mb:2},children:"Analytics"}),r.jsx(h,{variant:"body2",color:"text.secondary",children:"Analytics & reporting module (to be implemented)."})]})}),De=()=>r.jsx(M,{sx:{borderRadius:3},children:r.jsxs(U,{children:[r.jsx(h,{variant:"h5",sx:{fontWeight:"bold",mb:2},children:"Inventory"}),r.jsx(h,{variant:"body2",color:"text.secondary",children:"Inventory module (to be implemented)."})]})}),ke=()=>r.jsx(M,{sx:{borderRadius:3},children:r.jsxs(U,{children:[r.jsx(h,{variant:"h5",sx:{fontWeight:"bold",mb:2},children:"Settings"}),r.jsx(h,{variant:"body2",color:"text.secondary",children:"Platform settings module (to be implemented)."})]})}),Ae=()=>r.jsx(M,{sx:{borderRadius:3},children:r.jsxs(U,{children:[r.jsx(h,{variant:"h5",sx:{fontWeight:"bold",mb:2},children:"Audit Logs"}),r.jsx(h,{variant:"body2",color:"text.secondary",children:"Security & activity logs (to be implemented)."})]})}),Re=()=>{const[e,a]=i.useState([]),[s,t]=i.useState(!1),[l,o]=i.useState(0),[d,c]=i.useState(10),[u,g]=i.useState(0),[j,p]=i.useState(""),[b,f]=i.useState(""),[v,y]=i.useState(""),[C,w]=i.useState(null),[N,E]=i.useState(!1),[I,P]=i.useState(!1),[D,k]=i.useState(""),[L,T]=i.useState(""),[G,K]=i.useState(null),[Z,ie]=i.useState({open:!1,message:"",severity:"success"}),le=async()=>{t(!0);try{const e=new URLSearchParams({page:l.toString(),size:d.toString()});j&&e.append("status",j),b&&e.append("userId",b);const s=await ye.get(`/admin/warranty/requests?${e}`);s.success&&(a(s.data),g(s.totalElements||0)),Ce.info("T·∫£i danh s√°ch y√™u c·∫ßu b·∫£o h√†nh th√†nh c√¥ng")}catch(e){oe("Kh√¥ng th·ªÉ t·∫£i danh s√°ch y√™u c·∫ßu b·∫£o h√†nh","error"),Ce.error("Kh√¥ng th·ªÉ t·∫£i danh s√°ch y√™u c·∫ßu b·∫£o h√†nh")}finally{t(!1)}},ne=async()=>{try{const e=await ye.get("/admin/warranty/stats");e.success&&K(e.data)}catch(e){}};i.useEffect(()=>{le(),ne()},[l,d,j,b]);const oe=(e,a)=>{ie({open:!0,message:e,severity:a})},de=e=>{switch(e){case"PENDING":return"warning";case"APPROVED":return"info";case"RECEIVED":return"primary";case"IN_PROGRESS":return"secondary";case"COMPLETED":return"success";case"REJECTED":return"error";default:return"default"}},ce=e=>{switch(e){case"PENDING":return r.jsx(je,{fontSize:"small"});case"APPROVED":case"COMPLETED":return r.jsx(te,{fontSize:"small"});case"RECEIVED":default:return r.jsx(ve,{fontSize:"small"});case"IN_PROGRESS":return r.jsx(S,{fontSize:"small"});case"REJECTED":return r.jsx(re,{fontSize:"small"})}},he=e=>{switch(e){case"HIGH":return"error";case"NORMAL":return"primary";case"LOW":return"success";default:return"default"}},xe=(e,a)=>{switch(o(0),e){case"status":p(a);break;case"userId":f(a)}},ue=e.filter(e=>""===v||e.requestNumber.toLowerCase().includes(v.toLowerCase())||e.customerName.toLowerCase().includes(v.toLowerCase())||e.productName.toLowerCase().includes(v.toLowerCase())),me=[{field:"requestNumber",headerName:"Request #",width:120,renderCell:e=>r.jsx(x,{label:e.value,size:"small",color:"primary",variant:"outlined"})},{field:"customerName",headerName:"Customer",width:150,renderCell:e=>r.jsxs(n,{children:[r.jsx(h,{variant:"body2",sx:{fontWeight:600},children:e.value}),r.jsxs(h,{variant:"caption",color:"text.secondary",children:["ID: ",e.row.userId]})]})},{field:"productName",headerName:"Product",width:180,renderCell:e=>r.jsx(h,{variant:"body2",children:e.value})},{field:"issueDescription",headerName:"Issue",width:200,renderCell:e=>r.jsx(h,{variant:"body2",noWrap:!0,children:e.value})},{field:"status",headerName:"Status",width:120,renderCell:e=>r.jsx(x,{label:e.value,size:"small",color:de(e.value),icon:ce(e.value),variant:"outlined"})},{field:"priority",headerName:"Priority",width:100,renderCell:e=>r.jsx(x,{label:e.value,size:"small",color:he(e.value),variant:"outlined"})},{field:"createdAt",headerName:"Created",width:120,renderCell:e=>r.jsx(h,{variant:"caption",children:new Date(e.value).toLocaleDateString()})},{field:"actions",headerName:"Actions",width:150,sortable:!1,filterable:!1,renderCell:e=>r.jsxs(A,{direction:"row",spacing:1,children:[r.jsx(m,{size:"small",color:"info",onClick:()=>{return a=e.row,w(a),void P(!0);var a},sx:{bgcolor:"info.50","&:hover":{bgcolor:"info.100"}},children:r.jsx(R,{fontSize:"small"})}),r.jsx(m,{size:"small",color:"primary",onClick:()=>{return a=e.row,w(a),k(a.status),T(""),void E(!0);var a},sx:{bgcolor:"primary.50","&:hover":{bgcolor:"primary.100"}},children:r.jsx(W,{fontSize:"small"})})]})}];return r.jsxs(n,{children:[r.jsxs(n,{sx:{mb:4},children:[r.jsx(h,{variant:"h4",sx:{fontWeight:900,mb:1,background:"linear-gradient(45deg, #3b82f6 0%, #2563eb 100%)",backgroundClip:"text",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent"},children:"Warranty Management"}),r.jsx(h,{variant:"body1",color:"text.secondary",children:"Manage warranty requests and repair technician assignments"})]}),r.jsx(O,{container:!0,spacing:3,sx:{mb:4},children:G&&r.jsxs(r.Fragment,{children:[r.jsx(O,{item:!0,xs:12,sm:6,md:3,children:r.jsx(M,{sx:{height:"100%",background:"linear-gradient(135deg, #f59e0b 0%, #d97706 100%)",color:"white"},children:r.jsx(U,{children:r.jsxs(n,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[r.jsxs(n,{children:[r.jsx(h,{variant:"h4",sx:{fontWeight:900,mb:1},children:G.PENDING}),r.jsx(h,{variant:"body2",sx:{opacity:.9},children:"Pending"})]}),r.jsx(je,{sx:{fontSize:40,opacity:.8}})]})})})}),r.jsx(O,{item:!0,xs:12,sm:6,md:3,children:r.jsx(M,{sx:{height:"100%",background:"linear-gradient(135deg, #10b981 0%, #059669 100%)",color:"white"},children:r.jsx(U,{children:r.jsxs(n,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[r.jsxs(n,{children:[r.jsx(h,{variant:"h4",sx:{fontWeight:900,mb:1},children:G.IN_PROGRESS}),r.jsx(h,{variant:"body2",sx:{opacity:.9},children:"In Progress"})]}),r.jsx(S,{sx:{fontSize:40,opacity:.8}})]})})})}),r.jsx(O,{item:!0,xs:12,sm:6,md:3,children:r.jsx(M,{sx:{height:"100%",background:"linear-gradient(135deg, #3b82f6 0%, #2563eb 100%)",color:"white"},children:r.jsx(U,{children:r.jsxs(n,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[r.jsxs(n,{children:[r.jsx(h,{variant:"h4",sx:{fontWeight:900,mb:1},children:G.COMPLETED}),r.jsx(h,{variant:"body2",sx:{opacity:.9},children:"Completed"})]}),r.jsx(te,{sx:{fontSize:40,opacity:.8}})]})})})}),r.jsx(O,{item:!0,xs:12,sm:6,md:3,children:r.jsx(M,{sx:{height:"100%",background:"linear-gradient(135deg, #ef4444 0%, #dc2626 100%)",color:"white"},children:r.jsx(U,{children:r.jsxs(n,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[r.jsxs(n,{children:[r.jsx(h,{variant:"h4",sx:{fontWeight:900,mb:1},children:G.REJECTED}),r.jsx(h,{variant:"body2",sx:{opacity:.9},children:"Rejected"})]}),r.jsx(re,{sx:{fontSize:40,opacity:.8}})]})})})})]})}),r.jsx(M,{sx:{mb:3,borderRadius:3,boxShadow:"0 8px 32px rgba(0,0,0,0.08)"},children:r.jsx(U,{children:r.jsxs(n,{sx:{display:"flex",gap:2,flexWrap:"wrap",alignItems:"center"},children:[r.jsx(J,{label:"Search",variant:"outlined",size:"small",value:v,onChange:e=>y(e.target.value),sx:{minWidth:200},InputProps:{startAdornment:r.jsx(pe,{sx:{mr:1,color:"text.secondary"}})}}),r.jsxs(V,{size:"small",sx:{minWidth:150},children:[r.jsx(F,{children:"Status"}),r.jsxs(H,{value:j,label:"Status",onChange:e=>xe("status",e.target.value),children:[r.jsx($,{value:"",children:"All Status"}),r.jsx($,{value:"PENDING",children:"Pending"}),r.jsx($,{value:"APPROVED",children:"Approved"}),r.jsx($,{value:"RECEIVED",children:"Received"}),r.jsx($,{value:"IN_PROGRESS",children:"In Progress"}),r.jsx($,{value:"COMPLETED",children:"Completed"}),r.jsx($,{value:"REJECTED",children:"Rejected"}),r.jsx($,{value:"CANCELLED",children:"Cancelled"})]})]}),r.jsx(J,{label:"User ID",variant:"outlined",size:"small",value:b,onChange:e=>xe("userId",e.target.value),sx:{minWidth:120}}),r.jsx(Y,{variant:"outlined",startIcon:r.jsx(be,{}),onClick:le,disabled:s,children:"Refresh"}),r.jsx(Y,{variant:"outlined",startIcon:r.jsx(fe,{}),onClick:()=>{p(""),f(""),y(""),o(0)},children:"Clear Filters"})]})})}),r.jsx(M,{sx:{borderRadius:3,boxShadow:"0 8px 32px rgba(0,0,0,0.08)"},children:r.jsxs(U,{children:[r.jsx(n,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:r.jsxs(h,{variant:"h6",sx:{fontWeight:700},children:["Warranty Requests (",u,")"]})}),r.jsx(n,{sx:{height:600,width:"100%"},children:r.jsx(_,{rows:ue,columns:me,pagination:!0,paginationMode:"server",rowCount:u,loading:s,getRowId:e=>e.id,sx:{border:"none","& .MuiDataGrid-cell":{borderBottom:"1px solid #f0f0f0"},"& .MuiDataGrid-columnHeaders":{bgcolor:"#f8fafc",borderBottom:"2px solid #e2e8f0"},"& .MuiDataGrid-row:hover":{bgcolor:"#f8fafc"}},paginationModel:{page:l,pageSize:d},onPaginationModelChange:e=>{o(e.page),c(e.pageSize)},pageSizeOptions:[10,25,50]})})]})}),r.jsxs(B,{open:I,onClose:()=>P(!1),maxWidth:"md",fullWidth:!0,children:[r.jsxs(q,{sx:{bgcolor:"info.main",color:"white",display:"flex",alignItems:"center",gap:1},children:[r.jsx(R,{}),"View Warranty Request - ",null==C?void 0:C.requestNumber]}),r.jsx(Q,{sx:{pt:3},children:C&&r.jsxs(O,{container:!0,spacing:3,children:[r.jsxs(O,{item:!0,xs:12,md:6,children:[r.jsx(h,{variant:"h6",sx:{mb:2,fontWeight:600},children:"Customer Information"}),r.jsx(J,{fullWidth:!0,label:"Customer Name",value:C.customerName,InputProps:{readOnly:!0},sx:{mb:2}}),r.jsx(J,{fullWidth:!0,label:"Email",value:C.customerEmail,InputProps:{readOnly:!0},sx:{mb:2}}),r.jsx(J,{fullWidth:!0,label:"Phone",value:C.customerPhone||"N/A",InputProps:{readOnly:!0},sx:{mb:2}})]}),r.jsxs(O,{item:!0,xs:12,md:6,children:[r.jsx(h,{variant:"h6",sx:{mb:2,fontWeight:600},children:"Product Information"}),r.jsx(J,{fullWidth:!0,label:"Product Name",value:C.productName,InputProps:{readOnly:!0},sx:{mb:2}}),r.jsx(J,{fullWidth:!0,label:"Product SKU",value:C.productSku||"N/A",InputProps:{readOnly:!0},sx:{mb:2}}),r.jsx(J,{fullWidth:!0,label:"Order Number",value:C.orderNumber,InputProps:{readOnly:!0},sx:{mb:2}})]}),r.jsxs(O,{item:!0,xs:12,children:[r.jsx(h,{variant:"h6",sx:{mb:2,fontWeight:600},children:"Issue Description"}),r.jsx(J,{fullWidth:!0,multiline:!0,rows:3,value:C.issueDescription,InputProps:{readOnly:!0}})]}),r.jsxs(O,{item:!0,xs:12,md:6,children:[r.jsx(h,{variant:"h6",sx:{mb:2,fontWeight:600},children:"Request Details"}),r.jsx(J,{fullWidth:!0,label:"Status",value:C.status,InputProps:{readOnly:!0},sx:{mb:2}}),r.jsx(J,{fullWidth:!0,label:"Priority",value:C.priority,InputProps:{readOnly:!0},sx:{mb:2}}),r.jsx(J,{fullWidth:!0,label:"Created Date",value:new Date(C.createdAt).toLocaleString(),InputProps:{readOnly:!0}})]}),r.jsxs(O,{item:!0,xs:12,md:6,children:[r.jsx(h,{variant:"h6",sx:{mb:2,fontWeight:600},children:"Additional Information"}),C.rejectionReason&&r.jsx(J,{fullWidth:!0,label:"Rejection Reason",multiline:!0,rows:2,value:C.rejectionReason,InputProps:{readOnly:!0},sx:{mb:2}}),C.resolutionNotes&&r.jsx(J,{fullWidth:!0,label:"Resolution Notes",multiline:!0,rows:2,value:C.resolutionNotes,InputProps:{readOnly:!0},sx:{mb:2}}),C.actualCompletionDate&&r.jsx(J,{fullWidth:!0,label:"Completion Date",value:new Date(C.actualCompletionDate).toLocaleString(),InputProps:{readOnly:!0}})]})]})}),r.jsx(X,{sx:{p:3,pt:2},children:r.jsx(Y,{onClick:()=>P(!1),startIcon:r.jsx(z,{}),children:"Close"})})]}),r.jsxs(B,{open:N,onClose:()=>E(!1),maxWidth:"md",fullWidth:!0,children:[r.jsxs(q,{sx:{bgcolor:"primary.main",color:"white",display:"flex",alignItems:"center",gap:1},children:[r.jsx(W,{}),"Update Warranty Status - ",null==C?void 0:C.requestNumber]}),r.jsx(Q,{sx:{pt:3},children:r.jsx(O,{container:!0,spacing:3,children:r.jsxs(O,{item:!0,xs:12,children:[r.jsxs(V,{fullWidth:!0,sx:{mb:2},children:[r.jsx(F,{children:"New Status"}),r.jsxs(H,{value:D,label:"New Status",onChange:e=>k(e.target.value),children:[r.jsx($,{value:"PENDING",children:"Pending"}),r.jsx($,{value:"APPROVED",children:"Approved"}),r.jsx($,{value:"RECEIVED",children:"Received"}),r.jsx($,{value:"IN_PROGRESS",children:"In Progress"}),r.jsx($,{value:"COMPLETED",children:"Completed"}),r.jsx($,{value:"REJECTED",children:"Rejected"}),r.jsx($,{value:"CANCELLED",children:"Cancelled"})]})]}),r.jsx(J,{fullWidth:!0,label:"Notes (optional)",value:L,onChange:e=>T(e.target.value),placeholder:"Add notes about this status change...",multiline:!0,rows:3})]})})}),r.jsxs(X,{sx:{p:3,pt:2},children:[r.jsx(Y,{onClick:()=>E(!1),startIcon:r.jsx(z,{}),children:"Cancel"}),r.jsx(Y,{variant:"contained",onClick:async()=>{if(C&&D)try{(await ye.put(`/admin/warranty/requests/${C.id}/status`,{status:D,notes:L||void 0})).success&&(oe("C·∫≠p nh·∫≠t tr·∫°ng th√°i th√†nh c√¥ng","success"),Ce.success("C·∫≠p nh·∫≠t tr·∫°ng th√°i th√†nh c√¥ng"),E(!1),le(),ne())}catch(e){oe("Kh√¥ng th·ªÉ c·∫≠p nh·∫≠t tr·∫°ng th√°i","error"),Ce.error("Kh√¥ng th·ªÉ c·∫≠p nh·∫≠t tr·∫°ng th√°i")}},startIcon:r.jsx(ee,{}),children:"Update Status"})]})]}),r.jsx(ae,{open:Z.open,autoHideDuration:6e3,onClose:()=>ie({...Z,open:!1}),children:r.jsx(se,{onClose:()=>ie({...Z,open:!1}),severity:Z.severity,sx:{width:"100%"},children:Z.message})})]})};export{Pe as A,De as I,Se as O,Ne as P,ke as S,Ee as U,Ie as V,Re as W,Ae as a,we as b};
